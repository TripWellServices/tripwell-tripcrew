datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Traveler {
  id             String     @id @default(uuid())
  firebaseId     String?    @unique
  email          String?    @unique
  firstName      String?
  lastName       String?
  photoUrl       String?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  tripCrewsOwned TripCrew[] @relation("TripCrewOwner")
  tripsOwned     Trip[]     @relation("TripOwner") // Universal personhood - Traveler owns trips
}

model TripCrew {
  id          String   @id @default(uuid())
  name        String
  description String?
  ownerId     String
  owner       Traveler @relation("TripCrewOwner", fields: [ownerId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  trips       Trip[]
}

model Trip {
  id          String         @id @default(uuid())
  name        String
  destination String?
  startDate   DateTime?
  endDate     DateTime?
  coverImage  String?
  ownerId     String         // Traveler who owns/created this trip (universal personhood)
  owner       Traveler       @relation("TripOwner", fields: [ownerId], references: [id])
  tripCrewId  String?        // Optional: trip can belong to a TripCrew
  tripCrew    TripCrew?      @relation(fields: [tripCrewId], references: [id], onDelete: Cascade)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  lodging     Lodging?
  dining      Dining[]
  attractions Attraction[]
  logistics   LogisticItem[]
  packItems   PackItem[]
}

model Lodging {
  id            String  @id @default(uuid())
  tripId        String  @unique
  title         String
  address       String?
  website       String?
  phone         String?
  googlePlaceId String?
  imageUrl      String?
  rating        Float?
  lat           Float?
  lng           Float?
  trip          Trip    @relation(fields: [tripId], references: [id])
}

model Dining {
  id                  String    @id @default(uuid())
  tripId              String
  title               String
  category            String?
  address             String?
  phone               String?
  website             String?
  googlePlaceId       String?   @unique
  imageUrl            String?
  rating              Float?
  lat                 Float?
  lng                 Float?
  distanceFromLodging Float?
  driveTimeMinutes    Int?
  itineraryDay        DateTime?
  trip                Trip      @relation(fields: [tripId], references: [id])
}

model Attraction {
  id                  String    @id @default(uuid())
  tripId              String
  title               String
  category            String?
  address             String?
  phone               String?
  website             String?
  googlePlaceId       String?   @unique
  imageUrl            String?
  rating              Float?
  lat                 Float?
  lng                 Float?
  distanceFromLodging Float?
  driveTimeMinutes    Int?
  itineraryDay        DateTime?
  trip                Trip      @relation(fields: [tripId], references: [id])
}

model LogisticItem {
  id         String  @id @default(uuid())
  tripId     String
  title      String
  detail     String?
  isComplete Boolean @default(false)
  trip       Trip    @relation(fields: [tripId], references: [id])
}

model PackItem {
  id       String  @id @default(uuid())
  tripId   String
  title    String
  isPacked Boolean @default(false)
  trip     Trip    @relation(fields: [tripId], references: [id])
}
